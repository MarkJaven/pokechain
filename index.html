<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PokéChain</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>
  <!-- Video Background -->
  <video autoplay loop muted playsinline class="bg-video">
    <source src="bg.mp4" type="video/mp4" />
  </video>

  <!-- Overlay -->
  <div class="overlay"></div>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top bg-transparent px-5">
    <a class="navbar-brand fs-3 fw-bold text-warning glow-text" href="#">Poké<span class="text-success">Chain</span></a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav gap-4 fs-5">
        <li class="nav-item"><a class="nav-link glow-hover" href="#">Profile</a></li>
        <li class="nav-item"><a class="nav-link glow-hover" href="#">Collection</a></li>
        <li class="nav-item"><a class="nav-link glow-hover" href="marketplace.html">Marketplace</a></li>
        <li class="nav-item"><a class="nav-link glow-hover" href="#">Tournament</a></li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <section class="hero-section text-center text-white">
    <div class="container d-flex flex-column justify-content-center align-items-center vh-100">
      <h1 class="display-1 fw-bold text-glow">Poké<span class="text-warning">Chain</span></h1>
      <p class="lead text-light mb-5">Enter the Arena of Blockchain Battles</p>
      <button id="getStartedButton" class="btn btn-glow btn-lg px-5 py-3">Get Started</button>
    </div>
  </section>

  <!-- MetaMask Connection Modal -->
  <div class="modal fade" id="metamaskModal" tabindex="-1" aria-labelledby="metamaskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title fw-bold" id="metamaskModalLabel">Connect Your Wallet</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <p class="modal-text">Connect your MetaMask wallet to enter the PokéChain universe</p>
          <button id="connectMetaMaskButton" class="btn btn-metamask w-100">
            <svg class="metamask-logo" viewBox="0 0 318.6 318.6" xmlns="http://www.w3.org/2000/svg">
              <polygon fill="#e2761b" stroke="#e2761b" points="274.1,35.5 174.6,109.4 193,65.8" />
              <polygon fill="#e4761b" stroke="#e4761b" points="44.4,35.5 143.1,110.1 125.6,65.8" />
              <polygon fill="#e4761b" stroke="#e4761b" points="238.3,206.8 211.8,247.4 268.5,263 284.8,207.7" />
              <polygon fill="#e4761b" stroke="#e4761b" points="33.9,207.7 50.1,263 106.8,247.4 80.3,206.8" />
              <polygon fill="#e4761b" stroke="#e4761b" points="103.6,138.2 87.8,162.1 144.1,164.6 142.1,104.1" />
              <polygon fill="#e4761b" stroke="#e4761b" points="214.9,138.2 175.9,103.4 174.6,164.6 230.8,162.1" />
              <polygon fill="#e4761b" stroke="#e4761b" points="106.8,247.4 140.6,230.9 111.4,208.1" />
              <polygon fill="#e4761b" stroke="#e4761b" points="177.9,230.9 211.8,247.4 207.1,208.1" />
            </svg>
            Connect MetaMask Wallet
          </button>
          <div class="loading-spinner">
            <div class="spinner-border" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="text-light mt-2">Connecting...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    const getStartedButton = document.getElementById('getStartedButton');
    const connectMetaMaskButton = document.getElementById('connectMetaMaskButton');
    const loadingSpinner = document.querySelector('.loading-spinner');
    
    // Initialize modal
    const metamaskModal = new bootstrap.Modal(document.getElementById('metamaskModal'));

    // Show modal when "Get Started" is clicked
    getStartedButton.addEventListener('click', () => {
      metamaskModal.show();
    });

    // Handle MetaMask connection
    connectMetaMaskButton.addEventListener('click', async () => {
      if (typeof window.ethereum !== 'undefined') {
        try {
          // Show loading spinner
          connectMetaMaskButton.style.display = 'none';
          loadingSpinner.style.display = 'block';
          
          // Request account access
          const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
          const account = accounts[0];
          
          console.log('Connected account:', account);
          
          // Wait a moment for user feedback
          setTimeout(() => {
            // Close modal
            metamaskModal.hide();
            
            // Redirect to tournament page
            window.location.href = 'tournament.html';
          }, 1000);
          
        } catch (error) {
          console.error('Connection error:', error);
          
          // Hide loading spinner
          loadingSpinner.style.display = 'none';
          connectMetaMaskButton.style.display = 'flex';
          
          // Show error message
          if (error.code === 4001) {
            alert('Connection rejected. Please approve the connection to continue.');
          } else {
            alert('Failed to connect wallet. Please try again.');
          }
        }
      } else {
        alert('MetaMask is not installed. Please install it to continue.');
        window.open('https://metamask.io/download/', '_blank');
      }
    });

    // Reset modal state when closed
    document.getElementById('metamaskModal').addEventListener('hidden.bs.modal', () => {
      loadingSpinner.style.display = 'none';
      connectMetaMaskButton.style.display = 'flex';
    });
  </script>
</body>
</html>